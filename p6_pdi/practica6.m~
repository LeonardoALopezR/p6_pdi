clear; clc;
%% Parte 4
figure
set(gcf, 'Name', 'Aplicacion de Correlacion', 'NumberTitle', 'Off');
%Lectura de imagenes
im1=imread('texto1.tif');
ima=imread('a.tif');
im2=imread('texto2.tif');
imday=imread('day.tif');

% Correlaci?n de las imagenes
corrImg1=xcorr2(im1,ima);
subplot(2,2,1),imshow(corrImg1,[]),title('Imagen texto "1" y "a" correlacionadas');

%Obtenemos el valor maximo de la correlacion y lo buscamos dentro de la
%misma correlacion para encontrar la imagen que se esta buscando
max1=max(max(corrImg1));
unos1 = ismember(corrImg1,max1);
total1=sum(sum(unos1));
matriz1 = unos1 .* 255;
%al final se hace una convolucion para poner la imagen en los puntos de
%maxima correlacion
imC=conv2(ima,matriz1);
subplot(2,2,2),imshow(imC,[]),title('Localizacion de la letra');


corrImg2=xcorr2(im2,imday);
subplot(2,2,3)
imshow(corrImg2,[]);

maximo2=max(corrImg2);
maximo2= sort(maximo2);
c2 = ismember(corrImg2,35631109);
c3 = ismember(corrImg2,34536979);
c4 = ismember(corrImg2,34092010);
 
matriz1 = c2 .* 255;
matriz2 = c3 .* 255;
matriz3 = c4 .* 255;

matriztotal= matriz1+matriz2+matriz3;
imC2=conv2(imday,matriztotal);
subplot(2,2,4)
imshow(imC2,[])

%Lo que hace es "colocar" un punto donde la correlaci?n tiene mayor valor. 
%Las dificultades del OCR m?s notorias son: la cantidad de procesamiento 
%que puede necesitar la m?quina para realizar el c?lculo, y que es muy 
%f?cil de que exista correlaci?n en patrones similares (una C con una A), 
%lo que provoca que se puedan llegar a confundir algunos patrones.
